<section id="catalogs" class="flex flex-col h-full">
  <div class="flex justify-between items-center my-5">
    <p-iconfield>
      <p-inputicon class="ph ph-magnifying-glass" />
      <input class="max-w-48 lg:max-w-full" type="text" pInputText placeholder="Search" [formControl]="searchControl" />
    </p-iconfield>
    <button pButton size="small" icon="ph ph-plus" label="New" (click)="openCreateDialog()"></button>
  </div>

  @if (!loading() && !error() && collections().length) {
  <div class="flex flex-col justify-between h-full">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-2 mb-5">
      @for (collection of collections(); track collection.id) {
      <app-card-collection-card [collection]="collection" (deleted)="reload()" (idSelected)="onIdSelected($event)" />
      }
    </div>
    <p-paginator (onPageChange)="onPageChange($event)" [first]="first()" [rows]="pageSize()"
      [totalRecords]="metadata()?.totalElements" [rowsPerPageOptions]="[10, 20, 30]" [style]="{
            background: 'transparent'
        }">
    </p-paginator>
  </div>
  }

  @if (loading()) {
  <div class="flex flex-col justify-center items-center h-full">
    <app-loading-spinner />
  </div>
  }

  @if (error()) {
  <div class="flex flex-col justify-center items-center h-full">
    <p-message severity="error" [text]="error()!"></p-message>
  </div>
  }

  @if (!loading() && !error() && collections().length === 0) {
  <div class="flex flex-col justify-center items-center h-full">
    <i class="ph ph-empty" style="font-size: 32px"></i>
    <span class="font-semibold">No collections found.</span>
    <span>Start by creating a <span class="text-yellow-300">New</span> one</span>
  </div>
  }
</section>

<app-card-collection-form type="CREATE" [visible]="isCreateDialogOpen()" (closed)="closeCreateDialog($event)"
  (submitted)="reload()" />

<app-card-collection-form type="UPDATE" [collectionId]="selectedCollectionId()" [visible]="isUpdateDialogOpen()"
  (closed)="closeUpdateDialog($event)" (submitted)="reload()" />

<p-confirmDialog></p-confirmDialog>